import{_ as x,O as m,P as u,Q as o,R as e,S as r,aB as i,U as c,J as p,V as v,aC as D,aD as f,T as g,W as w,aF as P}from"./index.31111e77.js";import{a as h,d,e as b,f as C}from"./format.d31db189.js";import{a as _}from"./QBtnGroup.7c5c9f0b.js";import{Q as V,a as S,b as y}from"./QTable.9f7aa3f2.js";import{Q as U}from"./QSpace.9dd36978.js";import{Q as N}from"./QForm.0e6ad86e.js";import{Q as B}from"./QPage.1fc117fb.js";import{C as k}from"./ClosePopup.f26b17bb.js";import"./moment.40bc58bf.js";import"./QMarkupTable.8f6b2af9.js";import"./QSelect.dd809d48.js";const G={name:"Ventas",data(){return{ventas:[],venta:{},ventaDialog:!1,loading:!1,actionPeriodo:"",gestiones:[],filter:"",roles:["Doctor","Enfermera","Administrativo","Secretaria"],columns:[{name:"actions",label:"Acciones",align:"center"},{name:"nombre",label:"Nombre",align:"left",field:"nombre"},{name:"descripcion",label:"Descripci\xF3n",align:"left",field:"descripcion"},{name:"unidad",label:"Unidad",align:"left",field:"unidad"},{name:"precio",label:"Precio",align:"left",field:"precio"},{name:"stock",label:"Stock",align:"left",field:"stock"},{name:"stock_minimo",label:"Stock m\xEDnimo",align:"left",field:"stock_minimo"},{name:"stock_maximo",label:"Stock m\xE1ximo",align:"left",field:"stock_maximo"}]}},mounted(){this.ventasGet()},methods:{ventaNew(){this.venta={name:"",email:"",password:"",area_id:1,ventaname:"",cargo:"",role:"Area"},this.actionPeriodo="Nuevo",this.ventaDialog=!0},ventasGet(){this.loading=!0,this.$axios.get("ventas").then(n=>{this.ventas=n.data.data}).catch(n=>{this.$alert.error(n.response.data.message)}).finally(()=>{this.loading=!1})},gestionGet(){this.loading=!0,this.$axios.get("gestiones").then(n=>{this.gestiones=n.data,this.loading=!1}).catch(n=>{this.$alert.error(n.response.data.message),this.loading=!1})},ventaPost(){this.loading=!0,this.$axios.post("ventas",this.venta).then(n=>{this.ventasGet(),this.ventaDialog=!1,this.$alert.success("Periodo creado")}).catch(n=>{this.$alert.error(n.response.data.message)}).finally(()=>{this.loading=!1})},ventaPut(){this.loading=!0,this.$axios.put("ventas/"+this.venta.id,this.venta).then(n=>{this.ventasGet(),this.ventaDialog=!1,this.$alert.success("Periodo actualizado")}).catch(n=>{this.$alert.error(n.response.data.message)}).finally(()=>{this.loading=!1})},ventaEdit(n){this.venta={...n},this.actionPeriodo="Editar",this.ventaDialog=!0},ventaDelete(n){this.$alert.dialog("\xBFDesea eliminar el venta?").onOk(()=>{this.loading=!0,this.$axios.delete("ventas/"+n).then(l=>{this.ventasGet(),this.$alert.success("Periodo eliminado")}).catch(l=>{this.$alert.error(l.response.data.message)}).finally(()=>{this.loading=!1})})}}},E={class:"text-right"};function q(n,l,I,T,a,s){return m(),u(B,{class:"q-pa-md"},{default:o(()=>[e(y,{rows:a.ventas,columns:a.columns,dense:"","wrap-cells":"",flat:"",bordered:"","rows-per-page-options":[0],title:"Ventas",filter:a.filter},{"top-right":o(()=>[e(r,{color:"positive",label:"Nueva venta","no-caps":"",icon:"add_circle_outline",loading:a.loading,to:"/ventaNuevo"},null,8,["loading"]),e(i,{modelValue:a.filter,"onUpdate:modelValue":l[0]||(l[0]=t=>a.filter=t),label:"Buscar",dense:"",outlined:""},{append:o(()=>[e(c,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-actions":o(t=>[e(V,{props:t},{default:o(()=>[e(S,{label:"Opciones","no-caps":"",size:"10px",dense:"",color:"primary"},{default:o(()=>[e(_,null,{default:o(()=>[p((m(),u(h,{clickable:"",onClick:Q=>s.ventaEdit(t.row)},{default:o(()=>[e(d,{avatar:""},{default:o(()=>[e(c,{name:"edit"})]),_:1}),e(d,null,{default:o(()=>[e(b,null,{default:o(()=>l[12]||(l[12]=[v("Editar")])),_:1})]),_:1})]),_:2},1032,["onClick"])),[[k]]),p((m(),u(h,{clickable:"",onClick:Q=>s.ventaDelete(t.row.id)},{default:o(()=>[e(d,{avatar:""},{default:o(()=>[e(c,{name:"delete"})]),_:1}),e(d,null,{default:o(()=>[e(b,null,{default:o(()=>l[13]||(l[13]=[v("Eliminar")])),_:1})]),_:1})]),_:2},1032,["onClick"])),[[k]])]),_:2},1024)]),_:2},1024)]),_:2},1032,["props"])]),"body-cell-role":o(t=>[e(V,{props:t},{default:o(()=>[e(C,{label:t.row.role,color:t.row.color,"text-color":"white",dense:"",size:"14px"},null,8,["label","color"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","filter"]),e(P,{modelValue:a.ventaDialog,"onUpdate:modelValue":l[11]||(l[11]=t=>a.ventaDialog=t),persistent:""},{default:o(()=>[e(D,{style:{width:"400px",margin:"0 auto"}},{default:o(()=>[e(f,{class:"q-pb-none row items-center"},{default:o(()=>[g("div",null,w(a.actionPeriodo)+" venta ",1),e(U),e(r,{icon:"close",flat:"",round:"",dense:"",onClick:l[1]||(l[1]=t=>a.ventaDialog=!1)})]),_:1}),e(f,{class:"q-pt-none"},{default:o(()=>[e(N,{onSubmit:l[10]||(l[10]=t=>a.venta.id?s.ventaPut():s.ventaPost())},{default:o(()=>[e(i,{modelValue:a.venta.nombre,"onUpdate:modelValue":l[2]||(l[2]=t=>a.venta.nombre=t),label:"Nombre",dense:"",outlined:"",rules:[t=>!!t||"Campo requerido"]},null,8,["modelValue","rules"]),e(i,{modelValue:a.venta.descripcion,"onUpdate:modelValue":l[3]||(l[3]=t=>a.venta.descripcion=t),label:"Descripci\xF3n",dense:"",outlined:"",hint:""},null,8,["modelValue"]),e(i,{modelValue:a.venta.unidad,"onUpdate:modelValue":l[4]||(l[4]=t=>a.venta.unidad=t),label:"Unidad",dense:"",outlined:"",hint:""},null,8,["modelValue"]),e(i,{modelValue:a.venta.precio,"onUpdate:modelValue":l[5]||(l[5]=t=>a.venta.precio=t),label:"Precio",dense:"",outlined:"",hint:"",type:"number",step:"0.01"},null,8,["modelValue"]),e(i,{modelValue:a.venta.stock,"onUpdate:modelValue":l[6]||(l[6]=t=>a.venta.stock=t),label:"Stock",dense:"",outlined:"",hint:""},null,8,["modelValue"]),e(i,{modelValue:a.venta.stock_minimo,"onUpdate:modelValue":l[7]||(l[7]=t=>a.venta.stock_minimo=t),label:"Stock m\xEDnimo",dense:"",outlined:"",hint:""},null,8,["modelValue"]),e(i,{modelValue:a.venta.stock_maximo,"onUpdate:modelValue":l[8]||(l[8]=t=>a.venta.stock_maximo=t),label:"Stock m\xE1ximo",dense:"",outlined:"",hint:""},null,8,["modelValue"]),g("div",E,[e(r,{color:"negative",label:"Cancelar",onClick:l[9]||(l[9]=t=>a.ventaDialog=!1),"no-caps":"",loading:a.loading},null,8,["loading"]),e(r,{color:"primary",label:"Guardar",type:"submit","no-caps":"",loading:a.loading,class:"q-ml-sm"},null,8,["loading"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var M=x(G,[["render",q]]);export{M as default};
