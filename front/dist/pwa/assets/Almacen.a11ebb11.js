import{_ as D,O as m,P as u,Q as t,R as a,S as n,ax as s,U as p,J as c,V as f,ay as y,az as g,T as b,W as v,aA as w}from"./index.248e54b0.js";import{d as x,e as h,f as d,g as V}from"./format.ab99b20b.js";import{Q as k}from"./QBtnDropdown.861144b7.js";import{Q,a as U,b as q}from"./moment.106bacac.js";import{Q as _}from"./QMarkupTable.57b7b7ae.js";import{Q as N,a as S}from"./QForm.3f39d0dd.js";import{Q as B}from"./QPage.3e0e6402.js";import{C as P}from"./ClosePopup.4c1f6cde.js";const G={name:"AlmacenPage",data(){return{materials:[],material:{},materialDialog:!1,loading:!1,actionPeriodo:"",gestiones:[],filter:"",columns:[{name:"actions",label:"Acciones",align:"center"},{name:"partida",label:"Partida",align:"left",field:"partida",sortable:!0},{name:"descripcion",label:"Descripci\xF3n",align:"left",field:"descripcion",sortable:!0},{name:"cantidad",label:"Cantidad",align:"left",field:"cantidad",sortable:!0},{name:"unidad",label:"Unidad",align:"left",field:"unidad",sortable:!0},{name:"precio",label:"Precio",align:"left",field:"precio",sortable:!0}],unidades:["Unidad","Metro","Kilogramo","Litro","Pieza","Paquete"]}},mounted(){this.materialsGet()},methods:{materialNew(){this.material={partida:"",descripcion:"",cantidad:"",unidad:"",precio:""},this.actionPeriodo="Nuevo",this.materialDialog=!0},materialsGet(){this.loading=!0,this.$axios.get("materials").then(r=>{this.materials=r.data}).catch(r=>{this.$alert.error(r.response.data.message)}).finally(()=>{this.loading=!1})},materialPost(){this.loading=!0,this.$axios.post("materials",this.material).then(r=>{this.materialsGet(),this.materialDialog=!1,this.$alert.success("Periodo creado")}).catch(r=>{this.$alert.error(r.response.data.message)}).finally(()=>{this.loading=!1})},materialPut(){this.loading=!0,this.$axios.put("materials/"+this.material.id,this.material).then(r=>{this.materialsGet(),this.materialDialog=!1,this.$alert.success("Periodo actualizado")}).catch(r=>{this.$alert.error(r.response.data.message)}).finally(()=>{this.loading=!1})},materialEdit(r){this.material={...r},this.actionPeriodo="Editar",this.materialDialog=!0},materialDelete(r){this.$alert.dialog("\xBFDesea eliminar el material?").onOk(()=>{this.loading=!0,this.$axios.delete("materials/"+r).then(l=>{this.materialsGet(),this.$alert.success("Periodo eliminado")}).catch(l=>{this.$alert.error(l.response.data.message)}).finally(()=>{this.loading=!1})})}}},z={class:"text-right"};function A(r,l,E,I,i,o){return m(),u(B,{class:"q-pa-md"},{default:t(()=>[a(U,{rows:i.materials,columns:i.columns,dense:"","wrap-cells":"",flat:"",bordered:"","rows-per-page-options":[0],title:"Almacen",filter:i.filter},{"top-right":t(()=>[a(n,{color:"primary",label:"Nuevo",onClick:o.materialNew,outline:"","no-caps":"",icon:"add_circle_outline",loading:i.loading},null,8,["onClick","loading"]),a(s,{modelValue:i.filter,"onUpdate:modelValue":l[0]||(l[0]=e=>i.filter=e),label:"Buscar",dense:"",outlined:""},{append:t(()=>[a(p,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-actions":t(e=>[a(Q,{props:e},{default:t(()=>[a(k,{label:"Opciones","no-caps":"",size:"10px",dense:"",color:"primary"},{default:t(()=>[a(x,null,{default:t(()=>[c((m(),u(h,{clickable:"",onClick:C=>o.materialEdit(e.row)},{default:t(()=>[a(d,{avatar:""},{default:t(()=>[a(p,{name:"edit"})]),_:1}),a(d,null,{default:t(()=>[a(V,null,{default:t(()=>l[10]||(l[10]=[f("Editar")])),_:1})]),_:1})]),_:2},1032,["onClick"])),[[P]]),c((m(),u(h,{clickable:"",onClick:C=>o.materialDelete(e.row.id)},{default:t(()=>[a(d,{avatar:""},{default:t(()=>[a(p,{name:"delete"})]),_:1}),a(d,null,{default:t(()=>[a(V,null,{default:t(()=>l[11]||(l[11]=[f("Eliminar")])),_:1})]),_:1})]),_:2},1032,["onClick"])),[[P]])]),_:2},1024)]),_:2},1024)]),_:2},1032,["props"])]),"body-cell-role":t(e=>[a(Q,{props:e},{default:t(()=>[a(_,{label:e.row.role,color:e.row.role==="Jefatura"?"primary":"positive","text-color":"white",dense:"",size:"14px"},null,8,["label","color"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","filter"]),a(w,{modelValue:i.materialDialog,"onUpdate:modelValue":l[9]||(l[9]=e=>i.materialDialog=e),persistent:""},{default:t(()=>[a(y,null,{default:t(()=>[a(g,{class:"q-pb-none row items-center"},{default:t(()=>[b("div",null,v(i.actionPeriodo)+" material ",1),a(N),a(n,{icon:"close",flat:"",round:"",dense:"",onClick:l[1]||(l[1]=e=>i.materialDialog=!1)})]),_:1}),a(g,{class:"q-pt-none"},{default:t(()=>[a(S,{onSubmit:l[8]||(l[8]=e=>i.material.id?o.materialPut():o.materialPost())},{default:t(()=>[a(s,{modelValue:i.material.partida,"onUpdate:modelValue":l[2]||(l[2]=e=>i.material.partida=e),label:"Partida",outlined:"",dense:"",type:"number",rules:[e=>e>0||"Partida es requerida"]},null,8,["modelValue","rules"]),a(s,{modelValue:i.material.descripcion,"onUpdate:modelValue":l[3]||(l[3]=e=>i.material.descripcion=e),label:"Descripci\xF3n",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"]),a(s,{modelValue:i.material.cantidad,"onUpdate:modelValue":l[4]||(l[4]=e=>i.material.cantidad=e),label:"Cantidad",outlined:"",dense:"",type:"number",rules:[e=>e>0||"Cantidad es requerida"]},null,8,["modelValue","rules"]),a(q,{modelValue:i.material.unidad,"onUpdate:modelValue":l[5]||(l[5]=e=>i.material.unidad=e),label:"Unidad",outlined:"",dense:"",options:i.unidades,rules:[e=>!!e||"Unidad es requerida"]},null,8,["modelValue","options","rules"]),a(s,{modelValue:i.material.precio,"onUpdate:modelValue":l[6]||(l[6]=e=>i.material.precio=e),label:"Precio",outlined:"",dense:"",type:"number",step:.01,rules:[e=>e>0||"Precio es requerido"]},null,8,["modelValue","rules"]),b("div",z,[a(n,{color:"negative",label:"Cancelar",onClick:l[7]||(l[7]=e=>i.materialDialog=!1),"no-caps":"",loading:i.loading},null,8,["loading"]),a(n,{color:"primary",label:"Guardar",type:"submit","no-caps":"",loading:i.loading,class:"q-ml-sm"},null,8,["loading"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var W=D(G,[["render",A]]);export{W as default};
