import{_ as b,O as p,P,Q as i,R as r,aH as f,T as d,S as v,aF as a,$ as V,X as g,Y as C,Z as k,aG as c,U as u,aI as Q}from"./index.885221b7.js";import{Q as x}from"./QMarkupTable.3031e05e.js";import{Q as U}from"./QForm.ba7fe579.js";import{Q as y}from"./QPage.7e5e794c.js";const _={name:"ProveedoresPage",data(){return{proveedores:[],proveedoresFiltrados:[],proveedor:{},filtro:"",dialog:!1,loading:!1}},mounted(){this.obtenerProveedores()},methods:{obtenerProveedores(){this.loading=!0,this.$axios.get("proveedores").then(t=>{this.proveedores=t.data,this.filtrarProveedores()}).finally(()=>{this.loading=!1})},filtrarProveedores(){const t=this.filtro.toLowerCase();this.proveedoresFiltrados=this.proveedores.filter(e=>e.nombre.toLowerCase().includes(t)||e.email&&e.email.toLowerCase().includes(t))},nuevoProveedor(){this.proveedor={},this.dialog=!0},editarProveedor(t){this.proveedor={...t},this.dialog=!0},guardarProveedor(){this.loading=!0,(this.proveedor.id?this.$axios.put(`proveedores/${this.proveedor.id}`,this.proveedor):this.$axios.post("proveedores",this.proveedor)).then(()=>{this.dialog=!1,this.obtenerProveedores(),this.$alert.success("Proveedor guardado")}).catch(e=>{var n,s;this.$alert.error(((s=(n=e.response)==null?void 0:n.data)==null?void 0:s.message)||"Error al guardar")})},eliminarProveedor(t){this.$alert.dialog("\xBFDesea eliminar este proveedor?").onOk(()=>{this.$axios.delete(`proveedores/${t}`).then(()=>{this.obtenerProveedores(),this.$alert.success("Proveedor eliminado")}).catch(e=>{var n,s;this.$alert.error(((s=(n=e.response)==null?void 0:n.data)==null?void 0:s.message)||"Error al eliminar")})})}}},q={class:"row items-center q-gutter-sm"},w={class:"text-h6"},B={class:"text-right q-mt-sm"};function E(t,e,n,s,l,m){return p(),P(y,{class:"q-pa-md"},{default:i(()=>[r(c,{flat:"",bordered:""},{default:i(()=>[r(f,null,{default:i(()=>[d("div",q,[r(v,{label:"Nuevo Proveedor",color:"positive",onClick:m.nuevoProveedor,"no-caps":"",icon:"add",loading:l.loading},null,8,["onClick","loading"]),r(a,{modelValue:l.filtro,"onUpdate:modelValue":[e[0]||(e[0]=o=>l.filtro=o),m.filtrarProveedores],label:"Buscar proveedor",debounce:"300",outlined:"",dense:""},{append:i(()=>[r(V,{name:"search"})]),_:1},8,["modelValue","onUpdate:modelValue"])]),r(x,{dense:"",class:"q-mt-sm",flat:"",bordered:""},{default:i(()=>[e[8]||(e[8]=d("thead",null,[d("tr",null,[d("th",null,"Acciones"),d("th",null,"Nombre"),d("th",null,"CI"),d("th",null,"Tel\xE9fono"),d("th",null,"Direcci\xF3n"),d("th",null,"Email")])],-1)),d("tbody",null,[(p(!0),g(k,null,C(l.proveedoresFiltrados,o=>(p(),g("tr",{key:o.id},[d("td",null,[r(v,{icon:"edit",flat:"",dense:"",onClick:h=>m.editarProveedor(o),loading:l.loading},null,8,["onClick","loading"]),r(v,{icon:"delete",flat:"",dense:"",color:"negative",onClick:h=>m.eliminarProveedor(o.id),loading:l.loading},null,8,["onClick","loading"])]),d("td",null,u(o.nombre),1),d("td",null,u(o.ci),1),d("td",null,u(o.telefono),1),d("td",null,u(o.direccion),1),d("td",null,u(o.email),1)]))),128))])]),_:1})]),_:1})]),_:1}),r(Q,{modelValue:l.dialog,"onUpdate:modelValue":e[7]||(e[7]=o=>l.dialog=o)},{default:i(()=>[r(c,{style:{width:"400px"}},{default:i(()=>[r(f,null,{default:i(()=>[d("div",w,u(l.proveedor.id?"Editar":"Nuevo")+" Proveedor",1)]),_:1}),r(f,null,{default:i(()=>[r(U,{onSubmit:m.guardarProveedor},{default:i(()=>[r(a,{modelValue:l.proveedor.nombre,"onUpdate:modelValue":e[1]||(e[1]=o=>l.proveedor.nombre=o),label:"Nombre",outlined:"",dense:"",rules:[o=>!!o||"Campo requerido"]},null,8,["modelValue","rules"]),r(a,{modelValue:l.proveedor.ci,"onUpdate:modelValue":e[2]||(e[2]=o=>l.proveedor.ci=o),label:"CI",outlined:"",dense:""},null,8,["modelValue"]),r(a,{modelValue:l.proveedor.telefono,"onUpdate:modelValue":e[3]||(e[3]=o=>l.proveedor.telefono=o),label:"Tel\xE9fono",outlined:"",dense:""},null,8,["modelValue"]),r(a,{modelValue:l.proveedor.direccion,"onUpdate:modelValue":e[4]||(e[4]=o=>l.proveedor.direccion=o),label:"Direcci\xF3n",outlined:"",dense:""},null,8,["modelValue"]),r(a,{modelValue:l.proveedor.email,"onUpdate:modelValue":e[5]||(e[5]=o=>l.proveedor.email=o),label:"Email",outlined:"",dense:"",type:"email"},null,8,["modelValue"]),d("div",B,[r(v,{label:"Cancelar",flat:"",onClick:e[6]||(e[6]=o=>l.dialog=!1),loading:l.loading},null,8,["loading"]),r(v,{label:"Guardar",color:"primary",type:"submit",class:"q-ml-sm",loading:l.loading},null,8,["loading"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var S=b(_,[["render",E]]);export{S as default};
