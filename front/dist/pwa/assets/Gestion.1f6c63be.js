import{Q as n,a as m}from"./QForm.3f39d0dd.js";import{_ as g,O as b,P as Q,Q as a,R as e,S as t,ay as D,az as p,T as c,W as P,ax as u,aA as _}from"./index.248e54b0.js";import{Q as y}from"./QToolbar.6fe2e5f9.js";import{Q as x}from"./format.ab99b20b.js";import{h as d,Q as f,a as V,b as w}from"./moment.106bacac.js";import{Q as C}from"./QMarkupTable.57b7b7ae.js";import{Q as k}from"./QPage.3e0e6402.js";const v={data(){return{periodos:[],periodo:{},periodoDialog:!1,loading:!1,actionPeriodo:"",gestiones:[],columns:[{name:"actions",label:"Acciones",align:"center"},{name:"periodo",label:"Periodo",align:"left",field:"periodo",sortable:!0},{name:"estado",label:"Estado",align:"left",field:"estado",sortable:!0},{name:"fecha_inicio",label:"Fecha inicio",align:"left",field:"fecha_inicio",sortable:!0},{name:"fecha_fin",label:"Fecha fin",align:"left",field:"fecha_fin",sortable:!0}],peridosSelect:[]}},mounted(){this.periodosGet();let o=d().year();for(let i=o-5;i<=o+5;i++)this.peridosSelect.push(i)},methods:{newPeriodo(){this.periodo={periodo:d().year(),fecha_inicio:d().format("YYYY-MM-DD"),fecha_fin:d().format("YYYY-MM-DD")},this.actionPeriodo="Nuevo",this.periodoDialog=!0},periodosGet(){this.loading=!0,this.$axios.get("periodos").then(o=>{this.periodos=o.data}).catch(o=>{this.$alert.error(o.response.data.message)}).finally(()=>{this.loading=!1})},gestionGet(){this.loading=!0,this.$axios.get("gestiones").then(o=>{this.gestiones=o.data,this.loading=!1}).catch(o=>{this.$alert.error(o.response.data.message),this.loading=!1})},periodoPost(){this.loading=!0,this.$axios.post("periodos",this.periodo).then(o=>{this.periodosGet(),this.periodoDialog=!1,this.$alert.success("Periodo creado")}).catch(o=>{this.$alert.error(o.response.data.message)}).finally(()=>{this.loading=!1})},periodoPut(){this.loading=!0,this.$axios.put("periodos/"+this.periodo.id,this.periodo).then(o=>{this.periodosGet(),this.periodoDialog=!1,this.$alert.success("Periodo actualizado")}).catch(o=>{this.$alert.error(o.response.data.message)}).finally(()=>{this.loading=!1})},periodoEdit(o){this.periodo={...o},this.actionPeriodo="Editar",this.periodoDialog=!0},periodoDelete(o){this.$alert.dialog("\xBFDesea eliminar el periodo?").onOk(()=>{this.loading=!0,this.$axios.delete("periodos/"+o).then(i=>{this.periodosGet(),this.$alert.success("Periodo eliminado")}).catch(i=>{this.$alert.error(i.response.data.message)}).finally(()=>{this.loading=!1})})}}};function G(o,i,S,Y,s,r){return b(),Q(k,{class:"q-pa-md"},{default:a(()=>[e(V,{rows:s.periodos,columns:s.columns,dense:"","wrap-cells":"",flat:"",bordered:"","rows-per-page-options":[0],title:"Gestiones"},{"top-right":a(()=>[e(y,null,{default:a(()=>[e(n),e(t,{color:"primary",label:"Nuevo",onClick:r.newPeriodo,outline:"","no-caps":"",size:"10px",icon:"add_circle_outline",loading:s.loading},null,8,["onClick","loading"])]),_:1})]),"body-cell-actions":a(l=>[e(f,{props:l},{default:a(()=>[e(x,{flat:""},{default:a(()=>[e(t,{color:"primary",icon:"edit",onClick:h=>r.periodoEdit(l.row),dense:"",size:"10px"},null,8,["onClick"]),e(t,{color:"negative",icon:"delete",onClick:h=>r.periodoDelete(l.row.id),dense:"",size:"10px"},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["props"])]),"body-cell-estado":a(l=>[e(f,{props:l},{default:a(()=>[e(C,{label:l.row.estado,color:l.row.estado==="Vigente"?"green":l.row.estado==="Pr\xF3ximo"?"orange":"red","text-color":"white",dense:"",size:"14px"},null,8,["label","color"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"]),e(_,{modelValue:s.periodoDialog,"onUpdate:modelValue":i[6]||(i[6]=l=>s.periodoDialog=l),persistent:""},{default:a(()=>[e(D,null,{default:a(()=>[e(p,{class:"q-pb-none row items-center"},{default:a(()=>[c("div",null,P(s.actionPeriodo)+" periodo ",1),e(n),e(t,{icon:"close",flat:"",round:"",dense:"",onClick:i[0]||(i[0]=l=>s.periodoDialog=!1)})]),_:1}),e(p,{class:"q-pt-none"},{default:a(()=>[e(m,{onSubmit:i[5]||(i[5]=l=>s.periodo.id?r.periodoPut():r.periodoPost())},{default:a(()=>[e(w,{modelValue:s.periodo.periodo,"onUpdate:modelValue":i[1]||(i[1]=l=>s.periodo.periodo=l),label:"Periodo",outlined:"",dense:"",options:s.peridosSelect},null,8,["modelValue","options"]),e(u,{modelValue:s.periodo.fecha_inicio,"onUpdate:modelValue":i[2]||(i[2]=l=>s.periodo.fecha_inicio=l),label:"Fecha inicio",type:"date",outlined:"",dense:""},null,8,["modelValue"]),e(u,{modelValue:s.periodo.fecha_fin,"onUpdate:modelValue":i[3]||(i[3]=l=>s.periodo.fecha_fin=l),label:"Fecha fin",type:"date",outlined:"",dense:""},null,8,["modelValue"]),c("div",null,[e(t,{color:"negative",label:"Cancelar",onClick:i[4]||(i[4]=l=>s.periodoDialog=!1),"no-caps":"",loading:s.loading},null,8,["loading"]),e(t,{color:"primary",label:"Guardar",type:"submit","no-caps":"",loading:s.loading,class:"q-ml-sm"},null,8,["loading"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var T=g(v,[["render",G]]);export{T as default};
