import{_ as v,O as u,P as c,Q as a,R as o,S as d,aB as r,U as m,J as p,V as f,aC as D,aD as g,T as b,W as P,aF as C}from"./index.2cf8de7d.js";import{a as h,d as n,e as k,f as w}from"./format.e8b08a95.js";import{Q as S}from"./QList.156594eb.js";import{Q as _}from"./QBtnDropdown.2d26c6e1.js";import{Q as V,a as y}from"./QTable.3d078db5.js";import{Q as U}from"./QSpace.f7b112fa.js";import{Q as E}from"./QForm.b1918a55.js";import{Q as N}from"./QPage.1ba5f62e.js";import{C as x}from"./ClosePopup.80440ead.js";import"./moment.66cd1a64.js";import{E as G}from"./Excel.a5e16faf.js";import"./QBtnGroup.1009a850.js";import"./QMarkupTable.0b8458d2.js";import"./_commonjsHelpers.a26ce4be.js";const B={name:"ProductosPage",data(){return{productos:[],producto:{},productoDialog:!1,loading:!1,actionPeriodo:"",gestiones:[],filter:"",roles:["Doctor","Enfermera","Administrativo","Secretaria"],columns:[{name:"actions",label:"Acciones",align:"center"},{name:"nombre",label:"Nombre",align:"left",field:"nombre"},{name:"descripcion",label:"Descripci\xF3n",align:"left",field:"descripcion"},{name:"unidad",label:"Unidad",align:"left",field:"unidad"},{name:"precio",label:"Precio",align:"left",field:"precio"},{name:"stock",label:"Stock",align:"left",field:"stock"},{name:"stock_minimo",label:"Stock m\xEDnimo",align:"left",field:"stock_minimo"},{name:"stock_maximo",label:"Stock m\xE1ximo",align:"left",field:"stock_maximo"}]}},mounted(){this.productosGet()},methods:{exportExcel(){this.loading=!0,this.$axios.get("productosAll").then(i=>{let e=[{columns:[{label:"Nombre",value:"nombre"},{label:"Descripci\xF3n",value:"descripcion"},{label:"Unidad",value:"unidad"},{label:"Precio",value:"precio"},{label:"Stock",value:"stock"},{label:"Stock m\xEDnimo",value:"stock_minimo"},{label:"Stock m\xE1ximo",value:"stock_maximo"}],content:i.data}];G.export(e,"Productos")}).catch(i=>{this.$alert.error(i.response.data.message)}).finally(()=>{this.loading=!1})},productoNew(){this.producto={name:"",email:"",password:"",area_id:1,productoname:"",cargo:"",role:"Area"},this.actionPeriodo="Nuevo",this.productoDialog=!0},productosGet(){this.loading=!0,this.$axios.get("productos",{params:{search:this.filter}}).then(i=>{this.productos=i.data.data}).catch(i=>{this.$alert.error(i.response.data.message)}).finally(()=>{this.loading=!1})},gestionGet(){this.loading=!0,this.$axios.get("gestiones").then(i=>{this.gestiones=i.data,this.loading=!1}).catch(i=>{this.$alert.error(i.response.data.message),this.loading=!1})},productoPost(){this.loading=!0,this.$axios.post("productos",this.producto).then(i=>{this.productosGet(),this.productoDialog=!1,this.$alert.success("Periodo creado")}).catch(i=>{this.$alert.error(i.response.data.message)}).finally(()=>{this.loading=!1})},productoPut(){this.loading=!0,this.$axios.put("productos/"+this.producto.id,this.producto).then(i=>{this.productosGet(),this.productoDialog=!1,this.$alert.success("Periodo actualizado")}).catch(i=>{this.$alert.error(i.response.data.message)}).finally(()=>{this.loading=!1})},productoEdit(i){this.producto={...i},this.actionPeriodo="Editar",this.productoDialog=!0},productoDelete(i){this.$alert.dialog("\xBFDesea eliminar el producto?").onOk(()=>{this.loading=!0,this.$axios.delete("productos/"+i).then(e=>{this.productosGet(),this.$alert.success("Periodo eliminado")}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1})})}}},q={class:"text-right"};function I(i,e,A,T,t,s){return u(),c(N,{class:"q-pa-md"},{default:a(()=>[o(y,{rows:t.productos,columns:t.columns,dense:"","wrap-cells":"",flat:"",bordered:"","rows-per-page-options":[0],title:"Productos","hide-bottom":""},{"top-right":a(()=>[o(d,{color:"primary",label:"Descargar","no-caps":"",icon:"fa-solid fa-file-excel",loading:t.loading,onClick:s.exportExcel},null,8,["loading","onClick"]),o(d,{color:"green",label:"Nuevo",onClick:s.productoNew,"no-caps":"",icon:"add_circle_outline",loading:t.loading},null,8,["onClick","loading"]),o(r,{modelValue:t.filter,"onUpdate:modelValue":[e[0]||(e[0]=l=>t.filter=l),s.productosGet],label:"Buscar",dense:"",outlined:"",debounce:"300"},{append:a(()=>[o(m,{name:"search"})]),_:1},8,["modelValue","onUpdate:modelValue"])]),"body-cell-actions":a(l=>[o(V,{props:l},{default:a(()=>[o(_,{label:"Opciones","no-caps":"",size:"10px",dense:"",color:"primary"},{default:a(()=>[o(S,null,{default:a(()=>[p((u(),c(h,{clickable:"",onClick:Q=>s.productoEdit(l.row)},{default:a(()=>[o(n,{avatar:""},{default:a(()=>[o(m,{name:"edit"})]),_:1}),o(n,null,{default:a(()=>[o(k,null,{default:a(()=>e[12]||(e[12]=[f("Editar")])),_:1})]),_:1})]),_:2},1032,["onClick"])),[[x]]),p((u(),c(h,{clickable:"",onClick:Q=>s.productoDelete(l.row.id)},{default:a(()=>[o(n,{avatar:""},{default:a(()=>[o(m,{name:"delete"})]),_:1}),o(n,null,{default:a(()=>[o(k,null,{default:a(()=>e[13]||(e[13]=[f("Eliminar")])),_:1})]),_:1})]),_:2},1032,["onClick"])),[[x]])]),_:2},1024)]),_:2},1024)]),_:2},1032,["props"])]),"body-cell-role":a(l=>[o(V,{props:l},{default:a(()=>[o(w,{label:l.row.role,color:l.row.color,"text-color":"white",dense:"",size:"14px"},null,8,["label","color"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"]),o(C,{modelValue:t.productoDialog,"onUpdate:modelValue":e[11]||(e[11]=l=>t.productoDialog=l),persistent:""},{default:a(()=>[o(D,{style:{width:"400px",margin:"0 auto"}},{default:a(()=>[o(g,{class:"q-pb-none row items-center"},{default:a(()=>[b("div",null,P(t.actionPeriodo)+" producto ",1),o(U),o(d,{icon:"close",flat:"",round:"",dense:"",onClick:e[1]||(e[1]=l=>t.productoDialog=!1)})]),_:1}),o(g,{class:"q-pt-none"},{default:a(()=>[o(E,{onSubmit:e[10]||(e[10]=l=>t.producto.id?s.productoPut():s.productoPost())},{default:a(()=>[o(r,{modelValue:t.producto.nombre,"onUpdate:modelValue":e[2]||(e[2]=l=>t.producto.nombre=l),label:"Nombre",dense:"",outlined:"",rules:[l=>!!l||"Campo requerido"]},null,8,["modelValue","rules"]),o(r,{modelValue:t.producto.descripcion,"onUpdate:modelValue":e[3]||(e[3]=l=>t.producto.descripcion=l),label:"Descripci\xF3n",dense:"",outlined:"",hint:""},null,8,["modelValue"]),o(r,{modelValue:t.producto.unidad,"onUpdate:modelValue":e[4]||(e[4]=l=>t.producto.unidad=l),label:"Unidad",dense:"",outlined:"",hint:""},null,8,["modelValue"]),o(r,{modelValue:t.producto.precio,"onUpdate:modelValue":e[5]||(e[5]=l=>t.producto.precio=l),label:"Precio",dense:"",outlined:"",hint:"",type:"number",step:"0.01"},null,8,["modelValue"]),o(r,{modelValue:t.producto.stock,"onUpdate:modelValue":e[6]||(e[6]=l=>t.producto.stock=l),label:"Stock",dense:"",outlined:"",hint:""},null,8,["modelValue"]),o(r,{modelValue:t.producto.stock_minimo,"onUpdate:modelValue":e[7]||(e[7]=l=>t.producto.stock_minimo=l),label:"Stock m\xEDnimo",dense:"",outlined:"",hint:""},null,8,["modelValue"]),o(r,{modelValue:t.producto.stock_maximo,"onUpdate:modelValue":e[8]||(e[8]=l=>t.producto.stock_maximo=l),label:"Stock m\xE1ximo",dense:"",outlined:"",hint:""},null,8,["modelValue"]),b("div",q,[o(d,{color:"negative",label:"Cancelar",onClick:e[9]||(e[9]=l=>t.productoDialog=!1),"no-caps":"",loading:t.loading},null,8,["loading"]),o(d,{color:"primary",label:"Guardar",type:"submit","no-caps":"",loading:t.loading,class:"q-ml-sm"},null,8,["loading"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var $=v(B,[["render",I]]);export{$ as default};
